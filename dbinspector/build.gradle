apply plugin: "com.android.library"
apply plugin: "kotlin-android"
apply plugin: "kotlin-android-extensions"
apply from: "../config/quality.gradle"

version = "4.0.0"
group = "im.dino"

android {
    buildFeatures {
        viewBinding true
    }

    compileSdkVersion rootProject.ext.compile_sdk

    defaultConfig {
        minSdkVersion 21
        targetSdkVersion rootProject.ext.target_sdk
        versionCode 1
        versionName version

        buildConfigField "String", "AUTHORITY_PREFIX", "\"dbInspector_\""
    }

    resourcePrefix "dbinspector_"

    compileOptions {
        sourceCompatibility JavaVersion.VERSION_1_8
        targetCompatibility JavaVersion.VERSION_1_8
    }

    lintOptions {
        abortOnError false
    }

    kotlinOptions {
        jvmTarget = JavaVersion.VERSION_1_8.toString()
    }

    buildTypes {

        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile("proguard-android.txt"), "proguard-rules.txt"
        }
    }
}

dependencies {
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlin_version"
    implementation "androidx.appcompat:appcompat:1.2.0"
    implementation "com.google.android.material:material:1.2.1"
    implementation "androidx.fragment:fragment-ktx:1.2.5"
    implementation "androidx.recyclerview:recyclerview:1.1.0"
    implementation "androidx.viewpager:viewpager:1.0.0"
    implementation "androidx.lifecycle:lifecycle-common-java8:2.2.0"
    implementation "androidx.paging:paging-runtime:3.0.0-alpha06"
    implementation "androidx.startup:startup-runtime:1.0.0-beta01"
}

apply plugin: "maven"
apply plugin: "signing"

configurations {
    archives {
        extendsFrom configurations.default
    }
}

signing {
    sign configurations.archives
}

uploadArchives {
    configuration = configurations.archives
    repositories.mavenDeployer {
        beforeDeployment { MavenDeployment deployment -> signing.signPom(deployment) }

        repository(url: sonatypeRepo) {
            authentication(userName: sonatypeUsername,
                password: sonatypePassword)
        }

        pom.project {
            name "Android DbInspector"
            packaging "aar"
            description "Android library for viewing in app databases."
            url "https://github.com/infinum/android_dbinspector/"

            scm {
                url "scm:git@github.com:infinum/android_dbinspector.git"
                connection "scm:git@github.com:infinum/android_dbinspector.git"
                developerConnection "scm:git@github.com:infinum/android_dbinspector.git"
            }

            licenses {
                license {
                    name "The Apache Software License, Version 2.0"
                    url "http://www.apache.org/licenses/LICENSE-2.0.txt"
                    distribution "repo"
                }
            }

            developers {
                developer {
                    id "reisub"
                    name "Dino Kovaƒç"
                }
            }
        }
    }
}
